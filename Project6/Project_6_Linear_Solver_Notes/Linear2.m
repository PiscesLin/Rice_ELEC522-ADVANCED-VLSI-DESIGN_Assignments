A = [0.1 0.1 0.4 0.3; 
     0.2 0.8 0.6 0.5; 
     0.9 0.1 0.3 .2; 
     0.3 0.1 0.4 0.6]
[Q, R] = qr(A)
b = [0.2; 
     0.1; 
     0.8; 
     0.4]
QT = Q'
y = QT * b
n = 4
x=zeros(n,1)
c = cond(A)
if (R(n,n)==0) error('Matrix is singular!'); end;
x(4) = y(4)/R(4,4)
x(3) = (y(3) - (R(3,4) * x(4))) / R(3,3)
x(2) = (y(2) - (R(2,3) * x(3)) - (R(2,4) * x(4))) / R(2,2)
x(1) = (y(1) - (R(1,2) * x(2)) - (R(1,3) * x(3)) - (R(1,4) * x(4))) / R(1,1)