>> A = [0.1 0.1 0.4 0.3; 0.2 0.8 0.6 0.5 ; 0.9 0.1 0.3 .2; 0.3 0.1 0.4 0.6]

A =

    0.1000    0.1000    0.4000    0.3000
    0.2000    0.8000    0.6000    0.5000
    0.9000    0.1000    0.3000    0.2000
    0.3000    0.1000    0.4000    0.6000

>> condA = cond(A)

condA =

   11.2596

>> [Q, R] = qr(A)

Q =

   -0.1026   -0.0911    0.7655   -0.6286
   -0.2052   -0.9691   -0.1370    0.0071
   -0.9234    0.2291   -0.2473   -0.1836
   -0.3078   -0.0110    0.5780    0.7557


R =

   -0.9747   -0.2975   -0.5643   -0.5027
         0   -0.7625   -0.5535   -0.4727
         0         0    0.3810    0.4585
         0         0         0    0.2317

>> b = [0.2; 0.1; 0.8; 0.4]

b =

    0.2000
    0.1000
    0.8000
    0.4000

>> QT = Q'

QT =

   -0.1026   -0.2052   -0.9234   -0.3078
   -0.0911   -0.9691    0.2291   -0.0110
    0.7655   -0.1370   -0.2473    0.5780
   -0.6286    0.0071   -0.1836    0.7557

>> condQT = cond(QT)

condQT =

    1.0000

>> y = QT * b

y =

   -0.9029
    0.0638
    0.1728
    0.0304
 
>> n = 4

n =

     4

>> x=zeros(n,1)

x =

     0
     0
     0
     0

>> x(4) = y(4)/R(4,4)

x =

         0
         0
         0
    0.1311

>> x(3) = (y(3) - (R(3,4) * x(4))) / R(3,3)

x =

         0
         0
    0.2957
    0.1311

>> x(2) = (y(2) - (R(2,3) * x(3)) - (R(2,4) * x(4))) / R(2,2)

x =

         0
   -0.3796
    0.2957
    0.1311

>> x(1) = (y(1) - (R(1,2) * x(2)) - (R(1,3) * x(3)) - (R(1,4) * x(4))) / R(1,1)

x =

    0.8034
   -0.3796
    0.2957
    0.1311

>> A * x

ans =

    0.2000
    0.1000
    0.8000
    0.4000

>> 