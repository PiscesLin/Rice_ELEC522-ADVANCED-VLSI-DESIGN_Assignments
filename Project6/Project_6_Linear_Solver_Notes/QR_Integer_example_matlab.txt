>> A = [1 1 4 3; 2 7 6 5 ; 9 10 3 11; 16 1 14 13]

A =

     1     1     4     3
     2     7     6     5
     9    10     3    11
    16     1    14    13

>> condA = cond(A)

condA =

   29.5770

>> [Q, R] = qr(A)

Q =

   -0.0541   -0.0621    0.4667   -0.8806
   -0.1081   -0.6050    0.6756    0.4074
   -0.4867   -0.6553   -0.5385   -0.2093
   -0.8652    0.4481    0.1893    0.1218


R =

  -18.4932   -6.5429  -14.4377  -17.3036
         0  -10.4014    0.4293   -4.5939
         0         0    6.9547    1.3153
         0         0         0   -1.3231

>> b = [2; 10; 8; 4]

b =

     2
    10
     8
     4

>> n = 4;
>> QT = Q'

QT =

   -0.0541   -0.1081   -0.4867   -0.8652
   -0.0621   -0.6050   -0.6553    0.4481
    0.4667    0.6756   -0.5385    0.1893
   -0.8806    0.4074   -0.2093    0.1218

>> condQT = cond(QT)

condQT =

    1.0000

>> y = QT * b

y =

   -8.5437
   -9.6236
    4.1382
    1.1257

>> x=zeros(n,1)

x =

     0
     0
     0
     0

>> for j = n:-1:1
    if (R(j,j)==0) error('Matrix is singular!'); end;
    x(j)=y(j)/R(j,j);
    y(1:j-1)=y(1:j-1)-R(1:j-1,j)*x(j);
end
>> x

x =

    0.1966
    1.3322
    0.7559
   -0.8508

>> A * x

ans =

    2.0000
   10.0000
    8.0000
    4.0000

>> 